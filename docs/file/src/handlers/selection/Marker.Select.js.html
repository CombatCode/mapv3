<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">src/handlers/selection/Marker.Select.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-API">API</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/FigureIcon.js~FigureIcon.html">FigureIcon</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Map.js~Map.html">Map</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Overlay.js~Overlay.html">Overlay</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/Feature</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Feature/Feature.js~Feature.html">Feature</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Feature/FeatureCamera.js~FeatureCamera.html">FeatureCamera</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/MapSet</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/MapSet/MapSet.js~MapSet.html">MapSet</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">core</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/Component.js~Component.html">Component</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/Rest.js~Rest.html">Rest</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/Socket.js~Socket.html">Socket</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/Storage.js~Storage.html">Storage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-applyComponent">applyComponent</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/handlers/selection/Marker.Select.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import L from &apos;leaflet&apos;;


L.Handler.MarkerSelect = class MarkerSelect extends L.Handler {
    initialize(marker) {
        this._marker = marker;
    }

    addHooks() {
        this._marker.on(&apos;click&apos;, this._onClick, this);
        if (this._marker._icon) {
            L.DomUtil.addClass(this._icon, MarkerSelect.selectableClassName);
        }
    }

    removeHooks() {
        this._marker.off(&apos;click&apos;, this._onClick, this);
        if (this._marker._icon) {
            L.DomUtil.removeClass(this._icon, MarkerSelect.selectableClassName);
        }
    }

    selected() {
        return !!this._marker.options.selected;
    }

    select() {
        const marker = this._marker;
        if (!marker.options.selected) {
            marker.options.selected = true;
            this._setIconStyles(true);
            marker.fire(&apos;select&apos;);
            marker._map.fire(&apos;layerselect&apos;, {layer: marker});
            console.log(&apos;Marker &apos; + marker._leaflet_id + &apos; selected&apos;);
        }
    }

    deselect() {
        const marker = this._marker;
        if (marker.options.selected) {
            marker.options.selected = false;
            this._setIconStyles(false);
            marker.fire(&apos;deselect&apos;);
            marker._map.fire(&apos;layerdeselect&apos;, {layer: marker});
            console.log(&apos;Marker &apos; + marker._leaflet_id + &apos; deselected&apos;);
        }
    }

    _onClick() {
        console.log(&apos;click!&apos;);
        if (this._marker.options.selected) {
            this.deselect()
        } else {
            this.select()
        }
    }

    _setIconStyles(highlight) {
        let icon = this._marker._icon, offset;
        if (icon) {
            if (highlight) {
                L.DomUtil.addClass(icon, MarkerSelect.selectedClassName);
                offset = -parseInt(window.getComputedStyle(icon)[&apos;border-top-width&apos;], 10);
            } else {
                offset = parseInt(window.getComputedStyle(icon)[&apos;border-top-width&apos;], 10);
                L.DomUtil.removeClass(icon, MarkerSelect.selectedClassName);
            }
            icon.style.marginTop = parseInt(icon.style.marginTop, 10) + offset + &apos;px&apos;;
            icon.style.marginLeft = parseInt(icon.style.marginLeft, 10) + offset + &apos;px&apos;;
        }
    }
};

L.Handler.MarkerSelect.selectableClassName = &apos;leaflet-marker-selectable&apos;;

L.Handler.MarkerSelect.selectedClassName = &apos;leaflet-marker-selected&apos;;


// @namespace Marker
// @section Marker options
L.Marker.mergeOptions({
    // @option selectable: Boolean = true
    // Whether the marker is selectable using mouse/touch events or not.
    selectable: true,
    // @option selected: Boolean = false
    // Whether the marker is selected or not.
    selected: false
});


// Add init hook for MarkerSelect handler
L.Marker.addInitHook(function() {
    if (L.Handler.MarkerSelect) {
        this.selecting = new L.Handler.MarkerSelect(this);

        if (this.options.selectable) {
            this.selecting.enable();
        }
    }
});


function initIcon() {
    initIcon.base.call(this);
    if (this.options.selectable) {
        L.DomUtil.addClass(this._icon, &apos;leaflet-marker-selectable&apos;);
        if (this.options.selected) {
            L.DomUtil.addClass(this._icon, &apos;leaflet-marker-selected&apos;);
        }
    }
}

initIcon.base = L.Marker.prototype._initIcon;
L.Marker.prototype._initIcon = initIcon;
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.8)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
