<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/leaflet-draw/leaflet.draw.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SETTINGS">SETTINGS</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/FigureIcon.js~FigureIcon.html">FigureIcon</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Map.js~Map.html">Map</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Overlay.js~Overlay.html">Overlay</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/Feature</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Feature/FeatureCluster.js~FeatureCluster.html">FeatureCluster</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Feature/FeatureGroup.js~FeatureGroup.html">FeatureGroup</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createFeature">createFeature</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/MapSet</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/MapSet/MapSet.js~MapSet.html">MapSet</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/MapSet/MapSetComponent.js~MapSetComponent.html">MapSetComponent</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">core</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/Component.js~Component.html">Component</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/Rest.js~Rest.html">Rest</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/Socket.js~Socket.html">Socket</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/core/Storage.js~Storage.html">Storage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-applyComponent">applyComponent</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/leaflet-draw/leaflet.draw.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/*
	Leaflet.draw, a plugin that adds drawing and editing tools to Leaflet powered maps.
	(c) 2012-2016, Jacob Toye, Smartrak, Leaflet

	https://github.com/Leaflet/Leaflet.draw
	http://leafletjs.com
*/
!function(t,e,i){L.drawVersion=&quot;0.3.0-dev&quot;,L.drawLocal={draw:{toolbar:{actions:{title:&quot;Cancel drawing&quot;,text:&quot;Cancel&quot;},finish:{title:&quot;Finish drawing&quot;,text:&quot;Finish&quot;},undo:{title:&quot;Delete last point drawn&quot;,text:&quot;Delete last point&quot;},buttons:{polyline:&quot;Draw a polyline&quot;,polygon:&quot;Draw a polygon&quot;,rectangle:&quot;Draw a rectangle&quot;,circle:&quot;Draw a circle&quot;,marker:&quot;Draw a marker&quot;}},handlers:{circle:{tooltip:{start:&quot;Click and drag to draw circle.&quot;},radius:&quot;Radius&quot;},marker:{tooltip:{start:&quot;Click map to place marker.&quot;}},polygon:{tooltip:{start:&quot;Click to start drawing shape.&quot;,cont:&quot;Click to continue drawing shape.&quot;,end:&quot;Click first point to close this shape.&quot;}},polyline:{error:&quot;&lt;strong&gt;Error:&lt;/strong&gt; shape edges cannot cross!&quot;,tooltip:{start:&quot;Click to start drawing line.&quot;,cont:&quot;Click to continue drawing line.&quot;,end:&quot;Click last point to finish line.&quot;}},rectangle:{tooltip:{start:&quot;Click and drag to draw rectangle.&quot;}},simpleshape:{tooltip:{end:&quot;Release mouse to finish drawing.&quot;}}}},edit:{toolbar:{actions:{save:{title:&quot;Save changes.&quot;,text:&quot;Save&quot;},cancel:{title:&quot;Cancel editing, discards all changes.&quot;,text:&quot;Cancel&quot;}},buttons:{edit:&quot;Edit layers.&quot;,editDisabled:&quot;No layers to edit.&quot;,remove:&quot;Delete layers.&quot;,removeDisabled:&quot;No layers to delete.&quot;}},handlers:{edit:{tooltip:{text:&quot;Drag handles, or marker to edit feature.&quot;,subtext:&quot;Click cancel to undo changes.&quot;}},remove:{tooltip:{text:&quot;Click on a feature to remove&quot;}}}}},L.Draw={},L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&amp;&amp;e.shapeOptions&amp;&amp;(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire(&quot;enabled&quot;,{handler:this.type}),this._map.fire(&quot;draw:drawstart&quot;,{layerType:this.type}))},disable:function(){this._enabled&amp;&amp;(L.Handler.prototype.disable.call(this),this._map.fire(&quot;draw:drawstop&quot;,{layerType:this.type}),this.fire(&quot;disabled&quot;,{handler:this.type}))},addHooks:function(){var t=this._map;t&amp;&amp;(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,&quot;keyup&quot;,this._cancelDrawing,this))},removeHooks:function(){this._map&amp;&amp;(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,&quot;keyup&quot;,this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire(&quot;draw:created&quot;,{layer:t,layerType:this.type})},_cancelDrawing:function(t){27===t.keyCode&amp;&amp;this.disable()}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:&quot;polyline&quot;},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:&quot;#b00b00&quot;,timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:&quot;leaflet-div-icon leaflet-editing-icon&quot;}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:&quot;leaflet-div-icon leaflet-editing-icon leaflet-touch-icon&quot;}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:&quot;#f06eaa&quot;,weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,showLength:!0,zIndexOffset:2e3},initialize:function(t,e){L.Browser.touch&amp;&amp;(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&amp;&amp;e.drawError&amp;&amp;(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&amp;&amp;(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:&quot;leaflet-mouse-marker&quot;,iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on(&quot;mousedown&quot;,this._onMouseDown,this).on(&quot;mouseout&quot;,this._onMouseOut,this).on(&quot;mouseup&quot;,this._onMouseUp,this).on(&quot;mousemove&quot;,this._onMouseMove,this).addTo(this._map),this._map.on(&quot;mouseup&quot;,this._onMouseUp,this).on(&quot;mousemove&quot;,this._onMouseMove,this).on(&quot;zoomlevelschange&quot;,this._onZoomEnd,this).on(&quot;click&quot;,this._onTouch,this).on(&quot;zoomend&quot;,this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off(&quot;mousedown&quot;,this._onMouseDown,this).off(&quot;mouseout&quot;,this._onMouseOut,this).off(&quot;mouseup&quot;,this._onMouseUp,this).off(&quot;mousemove&quot;,this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off(&quot;mouseup&quot;,this._onMouseUp,this).off(&quot;mousemove&quot;,this._onMouseMove,this).off(&quot;zoomlevelschange&quot;,this._onZoomEnd,this).off(&quot;zoomend&quot;,this._onZoomEnd,this).off(&quot;click&quot;,this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length&lt;=1)){var t=this._markers.pop(),e=this._poly,i=this._poly.spliceLatLngs(e.getLatLngs().length-1,1)[0];this._markerGroup.removeLayer(t),e.getLatLngs().length&lt;2&amp;&amp;this._map.removeLayer(e),this._vertexChanged(i,!1)}},addVertex:function(t){var e=this._markers.length;return e&gt;0&amp;&amp;!this.options.allowIntersection&amp;&amp;this._poly.newLatLngIntersects(t)?void this._showErrorTooltip():(this._errorShown&amp;&amp;this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&amp;&amp;this._map.addLayer(this._poly),void this._vertexChanged(t,!0))},completeShape:function(){this._markers.length&lt;=1||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&amp;&amp;this.enable())},_finishShape:function(){var t=this._poly.newLatLngIntersects(this._poly.getLatLngs()[this._poly.getLatLngs().length-1]);return!this.options.allowIntersection&amp;&amp;t||!this._shapeIsValid()?void this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),void(this.options.repeatMode&amp;&amp;this.enable()))},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._updateGuide()},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),i=this._map.layerPointToLatLng(e);this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(e),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._map.fire(&quot;draw:drawvertex&quot;,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){var e=t.originalEvent;this._mouseDownOrigin=L.point(e.clientX,e.clientY)},_onMouseUp:function(e){if(this._mouseDownOrigin){var i=L.point(e.originalEvent.clientX,e.originalEvent.clientY).distanceTo(this._mouseDownOrigin);Math.abs(i)&lt;9*(t.devicePixelRatio||1)&amp;&amp;this.addVertex(e.latlng)}this._mouseDownOrigin=null},_onTouch:function(t){L.Browser.touch&amp;&amp;(this._onMouseDown(t),this._onMouseUp(t))},_onMouseOut:function(){this._tooltip&amp;&amp;this._tooltip._onMouseOut.call(this._tooltip)},_updateFinishHandler:function(){var t=this._markers.length;t&gt;1&amp;&amp;this._markers[t-1].on(&quot;click&quot;,this._finishShape,this),t&gt;2&amp;&amp;this._markers[t-2].off(&quot;click&quot;,this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers?this._markers.length:0;e&gt;0&amp;&amp;(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&amp;&amp;this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var i,o,n,s=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),a=this.options.guidelineDistance,r=this.options.maxGuideLineLength,h=s&gt;r?s-r:a;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create(&quot;div&quot;,&quot;leaflet-draw-guides&quot;,this._overlayPane));s&gt;h;h+=this.options.guidelineDistance)i=h/s,o={x:Math.floor(t.x*(1-i)+i*e.x),y:Math.floor(t.y*(1-i)+i*e.y)},n=L.DomUtil.create(&quot;div&quot;,&quot;leaflet-draw-guide-dash&quot;,this._guidesContainer),n.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(n,o)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,i=this._guidesContainer.childNodes.length;i&gt;e;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e,i=this.options.showLength;return 0===this._markers.length?t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(e=i?this._getMeasurementString():&quot;&quot;,t=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:e}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:e}),t},_updateRunningMeasure:function(t,e){var i,o,n=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(i=n-(e?2:1),o=t.distanceTo(this._markers[i].getLatLng()),this._measurementRunningTotal+=o*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return t=this._measurementRunningTotal+e.distanceTo(i),L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&amp;&amp;(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_cleanUpShape:function(){this._markers.length&gt;1&amp;&amp;this._markers[this._markers.length-1].off(&quot;click&quot;,this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:&quot;polygon&quot;},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:&quot;#f06eaa&quot;,weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&amp;&amp;this._markers[0].on(&quot;click&quot;,this._finishShape,this),t&gt;2&amp;&amp;(this._markers[t-1].on(&quot;dblclick&quot;,this._finishShape,this),t&gt;3&amp;&amp;this._markers[t-2].off(&quot;dblclick&quot;,this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length&lt;3?t=L.drawLocal.draw.handlers.polygon.tooltip.cont:(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area;return t?L.GeometryUtil.readableArea(t,this.options.metric):null},_shapeIsValid:function(){return this._markers.length&gt;=3},_vertexChanged:function(t,e){var i;!this.options.allowIntersection&amp;&amp;this.options.showArea&amp;&amp;(i=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(i)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;t&gt;0&amp;&amp;(this._markers[0].off(&quot;click&quot;,this._finishShape,this),t&gt;2&amp;&amp;this._markers[t-1].off(&quot;dblclick&quot;,this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&amp;&amp;(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&amp;&amp;this._map.dragging.disable(),this._container.style.cursor=&quot;crosshair&quot;,this._tooltip.updateContent({text:this._initialLabelText}),this._map.on(&quot;mousedown&quot;,this._onMouseDown,this).on(&quot;mousemove&quot;,this._onMouseMove,this).on(&quot;touchstart&quot;,this._onMouseDown,this).on(&quot;touchmove&quot;,this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&amp;&amp;(this._mapDraggable&amp;&amp;this._map.dragging.enable(),this._container.style.cursor=&quot;&quot;,this._map.off(&quot;mousedown&quot;,this._onMouseDown,this).off(&quot;mousemove&quot;,this._onMouseMove,this).off(&quot;touchstart&quot;,this._onMouseDown,this).off(&quot;touchmove&quot;,this._onMouseMove,this),L.DomEvent.off(e,&quot;mouseup&quot;,this._onMouseUp,this),L.DomEvent.off(e,&quot;touchend&quot;,this._onMouseUp,this),this._shape&amp;&amp;(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(e,&quot;mouseup&quot;,this._onMouseUp,this).on(e,&quot;touchend&quot;,this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&amp;&amp;(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(e))},_onMouseUp:function(){this._shape&amp;&amp;this._fireCreatedEvent(),this.disable(),this.options.repeatMode&amp;&amp;this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:&quot;rectangle&quot;},options:{shapeOptions:{stroke:!0,color:&quot;#f06eaa&quot;,weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_getTooltipText:function(){var t,e,i,o=L.Draw.SimpleShape.prototype._getTooltipText.call(this),n=this._shape;return n&amp;&amp;(t=this._shape.getLatLngs(),e=L.GeometryUtil.geodesicArea(t),i=L.GeometryUtil.readableArea(e,this.options.metric)),{text:o.text,subtext:i}}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:&quot;circle&quot;},options:{shapeOptions:{stroke:!0,color:&quot;#f06eaa&quot;,weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(t)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,i=t.latlng,o=this.options.showRadius,n=this.options.metric;this._tooltip.updatePosition(i),this._isDrawing&amp;&amp;(this._drawShape(i),e=this._shape.getRadius().toFixed(1),this._tooltip.updateContent({text:this._endLabelText,subtext:o?L.drawLocal.draw.handlers.circle.radius+&quot;: &quot;+L.GeometryUtil.readableDistance(e,n,this.options.feet):&quot;&quot;}))}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:&quot;marker&quot;},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&amp;&amp;(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:&quot;leaflet-mouse-marker&quot;,iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on(&quot;click&quot;,this._onClick,this).addTo(this._map),this._map.on(&quot;mousemove&quot;,this._onMouseMove,this),this._map.on(&quot;click&quot;,this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&amp;&amp;(this._marker&amp;&amp;(this._marker.off(&quot;click&quot;,this._onClick,this),this._map.off(&quot;click&quot;,this._onClick,this).off(&quot;click&quot;,this._onTouch,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off(&quot;click&quot;,this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off(&quot;mousemove&quot;,this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=new L.Marker(e,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on(&quot;click&quot;,this._onClick,this),this._map.on(&quot;click&quot;,this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&amp;&amp;this.enable()},_onTouch:function(t){this._onMouseMove(t),this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(t,e){this._marker=t,L.setOptions(this,e)},addHooks:function(){var t=this._marker;t.dragging.enable(),t.on(&quot;dragend&quot;,this._onDragEnd,t),this._toggleMarkerHighlight()},removeHooks:function(){var t=this._marker;t.dragging.disable(),t.off(&quot;dragend&quot;,this._onDragEnd,t),this._toggleMarkerHighlight()},_onDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(&quot;draw:editmove&quot;,{layer:e})},_toggleMarkerHighlight:function(){var t=this._marker._icon;t&amp;&amp;(t.style.display=&quot;none&quot;,L.DomUtil.hasClass(t,&quot;leaflet-edit-marker-selected&quot;)?(L.DomUtil.removeClass(t,&quot;leaflet-edit-marker-selected&quot;),this._offsetMarker(t,-4)):(L.DomUtil.addClass(t,&quot;leaflet-edit-marker-selected&quot;),this._offsetMarker(t,4)),t.style.display=&quot;&quot;)},_offsetMarker:function(t,e){var i=parseInt(t.style.marginTop,10)-e,o=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=i+&quot;px&quot;,t.style.marginLeft=o+&quot;px&quot;}}),L.Marker.addInitHook(function(){L.Edit.Marker&amp;&amp;(this.editing=new L.Edit.Marker(this),this.options.editable&amp;&amp;this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({options:{},initialize:function(t,e){this.latlngs=[t._latlngs],t._holes&amp;&amp;(this.latlngs=this.latlngs.concat(t._holes)),this._poly=t,L.setOptions(this,e),this._poly.on(&quot;revert-edited&quot;,this._updateLatLngs,this)},_eachVertexHandler:function(t){for(var e=0;e&lt;this._verticesHandlers.length;e++)t(this._verticesHandlers[e])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(t){t.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(t){t.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(t){t.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t&lt;this.latlngs.length;t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this.options))},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs],t.layer._holes&amp;&amp;(this.latlngs=this.latlngs.concat(t.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:&quot;leaflet-div-icon leaflet-editing-icon&quot;}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:&quot;leaflet-div-icon leaflet-editing-icon leaflet-touch-icon&quot;}),drawError:{color:&quot;#b00b00&quot;,timeout:1e3}},initialize:function(t,e,i){L.Browser.touch&amp;&amp;(this.options.icon=this.options.touchIcon),this._poly=t,i&amp;&amp;i.drawError&amp;&amp;(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this._latlngs=e,L.setOptions(this,i)},addHooks:function(){var t=this._poly;t instanceof L.Polygon||(t.options.editing.fill=!1),t.setStyle(t.options.editing),this._poly._map&amp;&amp;(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._poly;t.setStyle(t.options.original),t._map&amp;&amp;(t._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,o,n=this._latlngs;for(t=0,i=n.length;i&gt;t;t++)o=this._createMarker(n[t],t),o.on(&quot;click&quot;,this._onMarkerClick,this),this._markers.push(o);var s,a;for(t=0,e=i-1;i&gt;t;e=t++)(0!==t||L.Polygon&amp;&amp;this._poly instanceof L.Polygon)&amp;&amp;(s=this._markers[e],a=this._markers[t],this._createMiddleMarker(s,a),this._updatePrevNext(s,a))},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on(&quot;dragstart&quot;,this._onMarkerDragStart,this).on(&quot;drag&quot;,this._onMarkerDrag,this).on(&quot;dragend&quot;,this._fireEdit,this).on(&quot;touchmove&quot;,this._onTouchMove,this).on(&quot;MSPointerMove&quot;,this._onTouchMove,this).on(&quot;touchend&quot;,this._fireEdit,this).on(&quot;MSPointerUp&quot;,this._fireEdit,this),this._markerGroup.addLayer(i),i},_onMarkerDragStart:function(){this._poly.fire(&quot;editstart&quot;)},_spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._poly._convertLatLngs(this._latlngs,!0),this._poly.redraw(),t},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off(&quot;dragstart&quot;,this._onMarkerDragStart,this).off(&quot;drag&quot;,this._onMarkerDrag,this).off(&quot;dragend&quot;,this._fireEdit,this).off(&quot;touchmove&quot;,this._onMarkerDrag,this).off(&quot;touchend&quot;,this._fireEdit,this).off(&quot;click&quot;,this._onMarkerClick,this).off(&quot;MSPointerMove&quot;,this._onTouchMove,this).off(&quot;MSPointerUp&quot;,this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire(&quot;edit&quot;),this._poly._map.fire(&quot;draw:editvertex&quot;,{layers:this._markerGroup})},_onMarkerDrag:function(t){var e=t.target,i=this._poly;if(L.extend(e._origLatLng,e._latlng),e._middleLeft&amp;&amp;e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&amp;&amp;e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),i.options.poly){var o=i._map._editTooltip;if(!i.options.poly.allowIntersection&amp;&amp;i.intersects()){var n=i.options.color;i.setStyle({color:this.options.drawError.color}),o&amp;&amp;o.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){i.setStyle({color:n}),o&amp;&amp;o.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3),this._onMarkerClick(t)}}this._poly.redraw(),this._poly.fire(&quot;editdrag&quot;)},_onMarkerClick:function(t){var e=L.Polygon&amp;&amp;this._poly instanceof L.Polygon?4:3,i=t.target;this._latlngs.length&lt;e||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&amp;&amp;this._markerGroup.removeLayer(i._middleLeft),i._middleRight&amp;&amp;this._markerGroup.removeLayer(i._middleRight),i._prev&amp;&amp;i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e),o=t.target;L.extend(o._origLatLng,i),o._middleLeft&amp;&amp;o._middleLeft.setLatLng(this._getMiddleLatLng(o._prev,o)),o._middleRight&amp;&amp;o._middleRight.setLatLng(this._getMiddleLatLng(o,o._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(t,e){this._markerGroup.eachLayer(function(i){i._index&gt;t&amp;&amp;(i._index+=e)})},_createMiddleMarker:function(t,e){var i,o,n,s=this._getMiddleLatLng(t,e),a=this._createMarker(s);a.setOpacity(.6),t._middleRight=e._middleLeft=a,o=function(){var o=e._index;a._index=o,a.off(&quot;click&quot;,i,this).on(&quot;click&quot;,this._onMarkerClick,this),s.lat=a.getLatLng().lat,s.lng=a.getLatLng().lng,this._spliceLatLngs(o,0,s),this._markers.splice(o,0,a),a.setOpacity(1),this._updateIndexes(o,1),e._index++,this._updatePrevNext(t,a),this._updatePrevNext(a,e),this._poly.fire(&quot;editstart&quot;)},n=function(){a.off(&quot;dragstart&quot;,o,this),a.off(&quot;dragend&quot;,n,this),a.off(&quot;touchmove&quot;,o,this),this._createMiddleMarker(t,a),this._createMiddleMarker(a,e)},i=function(){o.call(this),n.call(this),this._fireEdit()},a.on(&quot;click&quot;,i,this).on(&quot;dragstart&quot;,o,this).on(&quot;dragend&quot;,n,this).on(&quot;touchmove&quot;,o,this),this._markerGroup.addLayer(a)},_updatePrevNext:function(t,e){t&amp;&amp;(t._next=e),e&amp;&amp;(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,o=i.project(t.getLatLng()),n=i.project(e.getLatLng());return i.unproject(o._add(n)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&amp;&amp;(this.editing=new L.Edit.Poly(this,this.options.poly),this.options.editable&amp;&amp;this.editing.enable()),this.on(&quot;add&quot;,function(){this.editing&amp;&amp;this.editing.enabled()&amp;&amp;this.editing.addHooks()}),this.on(&quot;remove&quot;,function(){this.editing&amp;&amp;this.editing.enabled()&amp;&amp;this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:&quot;leaflet-div-icon leaflet-editing-icon leaflet-edit-move&quot;}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:&quot;leaflet-div-icon leaflet-editing-icon leaflet-edit-resize&quot;}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:&quot;leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon&quot;}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:&quot;leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon&quot;})},initialize:function(t,e){L.Browser.touch&amp;&amp;(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){var t=this._shape;this._shape._map&amp;&amp;(this._map=this._shape._map,t.setStyle(t.options.editing),t._map&amp;&amp;(this._map=t._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var t=this._shape;if(t.setStyle(t.options.original),t._map){this._unbindMarker(this._moveMarker);for(var e=0,i=this._resizeMarkers.length;i&gt;e;e++)this._unbindMarker(this._resizeMarkers[e]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(t){t.on(&quot;dragstart&quot;,this._onMarkerDragStart,this).on(&quot;drag&quot;,this._onMarkerDrag,this).on(&quot;dragend&quot;,this._onMarkerDragEnd,this).on(&quot;touchstart&quot;,this._onTouchStart,this).on(&quot;touchmove&quot;,this._onTouchMove,this).on(&quot;MSPointerMove&quot;,this._onTouchMove,this).on(&quot;touchend&quot;,this._onTouchEnd,this).on(&quot;MSPointerUp&quot;,this._onTouchEnd,this)},_unbindMarker:function(t){t.off(&quot;dragstart&quot;,this._onMarkerDragStart,this).off(&quot;drag&quot;,this._onMarkerDrag,this).off(&quot;dragend&quot;,this._onMarkerDragEnd,this).off(&quot;touchstart&quot;,this._onTouchStart,this).off(&quot;touchmove&quot;,this._onTouchMove,this).off(&quot;MSPointerMove&quot;,this._onTouchMove,this).off(&quot;touchend&quot;,this._onTouchEnd,this).off(&quot;MSPointerUp&quot;,this._onTouchEnd,this)},_onMarkerDragStart:function(t){var e=t.target;e.setOpacity(0),this._shape.fire(&quot;editstart&quot;)},_fireEdit:function(){this._shape.edited=!0,this._shape.fire(&quot;edit&quot;)},_onMarkerDrag:function(t){var e=t.target,i=e.getLatLng();e===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),this._shape.fire(&quot;editdrag&quot;)},_onMarkerDragEnd:function(t){var e=t.target;e.setOpacity(1),this._fireEdit()},_onTouchStart:function(t){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t),&quot;function&quot;==typeof this._getCorners){var e=this._getCorners(),i=t.target,o=i._cornerIndex;i.setOpacity(0),this._oppositeCorner=e[(o+2)%4],this._toggleCornerMarkers(0,o)}this._shape.fire(&quot;editstart&quot;)},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e),o=t.target;return o===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),!1},_onTouchEnd:function(t){var e=t.target;e.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds(),e=t.getCenter();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,i=t.length;i&gt;e;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),i=t.target,o=i._cornerIndex;this._oppositeCorner=e[(o+2)%4],this._toggleCornerMarkers(0,o)},_onMarkerDragEnd:function(t){var e,i,o=t.target;o===this._moveMarker&amp;&amp;(e=this._shape.getBounds(),i=e.getCenter(),o.setLatLng(i)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,i=this._shape.getLatLngs(),o=this._shape.getBounds(),n=o.getCenter(),s=[],a=0,r=i.length;r&gt;a;a++)e=[i[a].lat-n.lat,i[a].lng-n.lng],s.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(s),this._repositionCornerMarkers(),this._map.fire(&quot;draw:editmove&quot;,{layer:this._shape})},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter()),this._map.fire(&quot;draw:editresize&quot;,{layer:this._shape})},_getCorners:function(){var t=this._shape.getBounds(),e=t.getNorthWest(),i=t.getNorthEast(),o=t.getSouthEast(),n=t.getSouthWest();return[e,i,o,n]},_toggleCornerMarkers:function(t){for(var e=0,i=this._resizeMarkers.length;i&gt;e;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,i=this._resizeMarkers.length;i&gt;e;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&amp;&amp;(this.editing=new L.Edit.Rectangle(this),this.options.editable&amp;&amp;this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(t);return this._map.unproject([i.x+e,i.y-e])},_move:function(t){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e),this._shape.setLatLng(t),this._map.fire(&quot;draw:editmove&quot;,{layer:this._shape})},_resize:function(t){var e=this._moveMarker.getLatLng(),i=e.distanceTo(t);this._shape.setRadius(i),this._map.fire(&quot;draw:editresize&quot;,{layer:this._shape})}}),L.Circle.addInitHook(function(){
L.Edit.Circle&amp;&amp;(this.editing=new L.Edit.Circle(this),this.options.editable&amp;&amp;this.editing.enable()),this.on(&quot;add&quot;,function(){this.editing&amp;&amp;this.editing.enabled()&amp;&amp;this.editing.addHooks()}),this.on(&quot;remove&quot;,function(){this.editing&amp;&amp;this.editing.enabled()&amp;&amp;this.editing.removeHooks()})}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,&quot;touchstart&quot;,this._onTouchStart,this),L.DomEvent.on(this._container,&quot;touchend&quot;,this._onTouchEnd,this),L.DomEvent.on(this._container,&quot;touchmove&quot;,this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,&quot;MSPointerDown&quot;,this._onTouchStart,this),L.DomEvent.on(this._container,&quot;MSPointerUp&quot;,this._onTouchEnd,this),L.DomEvent.on(this._container,&quot;MSPointerMove&quot;,this._onTouchMove,this),L.DomEvent.on(this._container,&quot;MSPointerCancel&quot;,this._onTouchCancel,this)):(L.DomEvent.on(this._container,&quot;touchcancel&quot;,this._onTouchCancel,this),L.DomEvent.on(this._container,&quot;touchleave&quot;,this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,&quot;touchstart&quot;,this._onTouchStart),L.DomEvent.off(this._container,&quot;touchend&quot;,this._onTouchEnd),L.DomEvent.off(this._container,&quot;touchmove&quot;,this._onTouchMove),this._detectIE()?(L.DomEvent.off(this._container,&quot;MSPointerDowm&quot;,this._onTouchStart),L.DomEvent.off(this._container,&quot;MSPointerUp&quot;,this._onTouchEnd),L.DomEvent.off(this._container,&quot;MSPointerMove&quot;,this._onTouchMove),L.DomEvent.off(this._container,&quot;MSPointerCancel&quot;,this._onTouchCancel)):(L.DomEvent.off(this._container,&quot;touchcancel&quot;,this._onTouchCancel),L.DomEvent.off(this._container,&quot;touchleave&quot;,this._onTouchLeave))},_touchEvent:function(t,e){var i={};if(&quot;undefined&quot;!=typeof t.touches){if(!t.touches.length)return;i=t.touches[0]}else{if(&quot;touch&quot;!==t.pointerType)return;if(i=t,!this._filterClick(t))return}var o=this._map.mouseEventToContainerPoint(i),n=this._map.mouseEventToLayerPoint(i),s=this._map.layerPointToLatLng(n);this._map.fire(e,{latlng:s,layerPoint:n,containerPoint:o,pageX:i.pageX,pageY:i.pageY,originalEvent:t})},_filterClick:function(t){var e=t.timeStamp||t.originalEvent.timeStamp,i=L.DomEvent._lastClick&amp;&amp;e-L.DomEvent._lastClick;return i&amp;&amp;i&gt;100&amp;&amp;500&gt;i||t.target._simulatedClick&amp;&amp;!t._simulated?(L.DomEvent.stop(t),!1):(L.DomEvent._lastClick=e,!0)},_onTouchStart:function(t){if(this._map._loaded){var e=&quot;touchstart&quot;;this._touchEvent(t,e)}},_onTouchEnd:function(t){if(this._map._loaded){var e=&quot;touchend&quot;;this._touchEvent(t,e)}},_onTouchCancel:function(t){if(this._map._loaded){var e=&quot;touchcancel&quot;;this._detectIE()&amp;&amp;(e=&quot;pointercancel&quot;),this._touchEvent(t,e)}},_onTouchLeave:function(t){if(this._map._loaded){var e=&quot;touchleave&quot;;this._touchEvent(t,e)}},_onTouchMove:function(t){if(this._map._loaded){var e=&quot;touchmove&quot;;this._touchEvent(t,e)}},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf(&quot;MSIE &quot;);if(i&gt;0)return parseInt(e.substring(i+5,e.indexOf(&quot;.&quot;,i)),10);var o=e.indexOf(&quot;Trident/&quot;);if(o&gt;0){var n=e.indexOf(&quot;rv:&quot;);return parseInt(e.substring(n+3,e.indexOf(&quot;.&quot;,n)),10)}var s=e.indexOf(&quot;Edge/&quot;);return s&gt;0?parseInt(e.substring(s+5,e.indexOf(&quot;.&quot;,s)),10):!1}}),L.Map.addInitHook(&quot;addHandler&quot;,&quot;touchExtend&quot;,L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=[&quot;dblclick&quot;,&quot;mousedown&quot;,&quot;mouseover&quot;,&quot;mouseout&quot;,&quot;contextmenu&quot;,&quot;touchstart&quot;,&quot;touchend&quot;,&quot;touchmove&quot;];this._detectIE?e.concat([&quot;MSPointerDown&quot;,&quot;MSPointerUp&quot;,&quot;MSPointerMove&quot;,&quot;MSPointerCancel&quot;]):e.concat([&quot;touchcancel&quot;]),L.DomUtil.addClass(t,&quot;leaflet-clickable&quot;),L.DomEvent.on(t,&quot;click&quot;,this._onMouseClick,this),L.DomEvent.on(t,&quot;keypress&quot;,this._onKeyPress,this);for(var i=0;i&lt;e.length;i++)L.DomEvent.on(t,e[i],this._fireMouseEvent,this);L.Handler.MarkerDrag&amp;&amp;(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&amp;&amp;this.dragging.enable())}},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf(&quot;MSIE &quot;);if(i&gt;0)return parseInt(e.substring(i+5,e.indexOf(&quot;.&quot;,i)),10);var o=e.indexOf(&quot;Trident/&quot;);if(o&gt;0){var n=e.indexOf(&quot;rv:&quot;);return parseInt(e.substring(n+3,e.indexOf(&quot;.&quot;,n)),10)}var s=e.indexOf(&quot;Edge/&quot;);return s&gt;0?parseInt(e.substring(s+5,e.indexOf(&quot;.&quot;,s)),10):!1}}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],i=0,o=t.length;o&gt;i;i++)e.push(this.cloneLatLng(t[i]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,i,o=t.length,n=0,s=L.LatLng.DEG_TO_RAD;if(o&gt;2){for(var a=0;o&gt;a;a++)e=t[a],i=t[(a+1)%o],n+=(i.lng-e.lng)*s*(2+Math.sin(e.lat*s)+Math.sin(i.lat*s));n=6378137*n*6378137/2}return Math.abs(n)},readableArea:function(t,e){var i;return e?i=t&gt;=1e4?(1e-4*t).toFixed(2)+&quot; ha&quot;:t.toFixed(2)+&quot; m&amp;sup2;&quot;:(t/=.836127,i=t&gt;=3097600?(t/3097600).toFixed(2)+&quot; mi&amp;sup2;&quot;:t&gt;=4840?(t/4840).toFixed(2)+&quot; acres&quot;:Math.ceil(t)+&quot; yd&amp;sup2;&quot;),i},readableDistance:function(t,e,i){var o;if(e)o=t&gt;1e3?(t/1e3).toFixed(2)+&quot; km&quot;:Math.ceil(t)+&quot; m&quot;;else if(t*=1.09361,t&gt;1760)o=(t/1760).toFixed(2)+&quot; miles&quot;;else{var n=&quot; yd&quot;;i&amp;&amp;(t=3*t,n=&quot; ft&quot;),o=Math.ceil(t)+n}return o}}),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,i,o){return this._checkCounterclockwise(t,i,o)!==this._checkCounterclockwise(e,i,o)&amp;&amp;this._checkCounterclockwise(t,e,i)!==this._checkCounterclockwise(t,e,o)},_checkCounterclockwise:function(t,e,i){return(i.y-t.y)*(e.x-t.x)&gt;(e.y-t.y)*(i.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,i,o=this._originalPoints,n=o?o.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=n-1;t&gt;=3;t--)if(e=o[t-1],i=o[t],this._lineSegmentsIntersectsRange(e,i,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(t),e):!1},newPointIntersects:function(t,e){var i=this._originalPoints,o=i?i.length:0,n=i?i[o-1]:null,s=o-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(n,t,s,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._originalPoints,i=e?e.length:0;return i+=t||0,!this._originalPoints||3&gt;=i},_lineSegmentsIntersectsRange:function(t,e,i,o){var n,s,a=this._originalPoints;o=o||0;for(var r=i;r&gt;o;r--)if(n=a[r-1],s=a[r],L.LineUtil.segmentsIntersect(t,e,n,s))return!0;return!1}}),L.Polygon.include({intersects:function(){var t,e,i,o,n,s=this._originalPoints;return this._tooFewPointsForIntersection()?!1:(t=L.Polyline.prototype.intersects.call(this))?!0:(e=s.length,i=s[0],o=s[e-1],n=e-2,this._lineSegmentsIntersectsRange(o,i,n,1))}}),L.Control.Draw=L.Control.extend({options:{position:&quot;topleft&quot;,draw:{},edit:!1},initialize:function(t){if(L.version&lt;&quot;0.7&quot;)throw new Error(&quot;Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/&quot;);L.Control.prototype.initialize.call(this,t);var e;this._toolbars={},L.DrawToolbar&amp;&amp;this.options.draw&amp;&amp;(e=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=e,this._toolbars[L.DrawToolbar.TYPE].on(&quot;enable&quot;,this._toolbarEnabled,this)),L.EditToolbar&amp;&amp;this.options.edit&amp;&amp;(e=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=e,this._toolbars[L.EditToolbar.TYPE].on(&quot;enable&quot;,this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(t){var e,i=L.DomUtil.create(&quot;div&quot;,&quot;leaflet-draw&quot;),o=!1,n=&quot;leaflet-draw-toolbar-top&quot;;for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&amp;&amp;(e=this._toolbars[s].addToolbar(t),e&amp;&amp;(o||(L.DomUtil.hasClass(e,n)||L.DomUtil.addClass(e.childNodes[0],n),o=!0),i.appendChild(e)));return i},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&amp;&amp;this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&amp;&amp;this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=t.target;for(var i in this._toolbars)this._toolbars[i]!==e&amp;&amp;this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&amp;&amp;(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&amp;&amp;this._activeMode.handler.disable()},addToolbar:function(t){var e,i=L.DomUtil.create(&quot;div&quot;,&quot;leaflet-draw-section&quot;),o=0,n=this._toolbarClass||&quot;&quot;,s=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create(&quot;div&quot;,&quot;leaflet-draw-toolbar leaflet-bar&quot;),this._map=t,e=0;e&lt;s.length;e++)s[e].enabled&amp;&amp;this._initModeHandler(s[e].handler,this._toolbarContainer,o++,n,s[e].title);return o?(this._lastButtonIndex=--o,this._actionsContainer=L.DomUtil.create(&quot;ul&quot;,&quot;leaflet-draw-actions&quot;),i.appendChild(this._toolbarContainer),i.appendChild(this._actionsContainer),i):void 0},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&amp;&amp;(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off(&quot;enabled&quot;,this._handlerActivated,this).off(&quot;disabled&quot;,this._handlerDeactivated,this));this._modes={};for(var e=0,i=this._actionButtons.length;i&gt;e;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,i,o,n){var s=t.type;this._modes[s]={},this._modes[s].handler=t,this._modes[s].button=this._createButton({type:s,title:n,className:o+&quot;-&quot;+s,container:e,callback:this._modes[s].handler.enable,context:this._modes[s].handler}),this._modes[s].buttonIndex=i,this._modes[s].handler.on(&quot;enabled&quot;,this._handlerActivated,this).on(&quot;disabled&quot;,this._handlerDeactivated,this)},_createButton:function(t){var e=L.DomUtil.create(&quot;a&quot;,t.className||&quot;&quot;,t.container);return e.href=&quot;#&quot;,t.text&amp;&amp;(e.innerHTML=t.text),t.title&amp;&amp;(e.title=t.title),L.DomEvent.on(e,&quot;click&quot;,L.DomEvent.stopPropagation).on(e,&quot;mousedown&quot;,L.DomEvent.stopPropagation).on(e,&quot;dblclick&quot;,L.DomEvent.stopPropagation).on(e,&quot;click&quot;,L.DomEvent.preventDefault).on(e,&quot;click&quot;,t.callback,t.context),e},_disposeButton:function(t,e){L.DomEvent.off(t,&quot;click&quot;,L.DomEvent.stopPropagation).off(t,&quot;mousedown&quot;,L.DomEvent.stopPropagation).off(t,&quot;dblclick&quot;,L.DomEvent.stopPropagation).off(t,&quot;click&quot;,L.DomEvent.preventDefault).off(t,&quot;click&quot;,e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,&quot;leaflet-draw-toolbar-button-enabled&quot;),this._showActionsToolbar(),this.fire(&quot;enable&quot;)},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,&quot;leaflet-draw-toolbar-button-enabled&quot;),this._activeMode=null,this.fire(&quot;disable&quot;)},_createActions:function(t){var e,i,o,n,s=this._actionsContainer,a=this.getActions(t),r=a.length;for(i=0,o=this._actionButtons.length;o&gt;i;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback);for(this._actionButtons=[];s.firstChild;)s.removeChild(s.firstChild);for(var h=0;r&gt;h;h++)&quot;enabled&quot;in a[h]&amp;&amp;!a[h].enabled||(e=L.DomUtil.create(&quot;li&quot;,&quot;&quot;,s),n=this._createButton({title:a[h].title,text:a[h].text,container:e,callback:a[h].callback,context:a[h].context}),this._actionButtons.push({button:n,callback:a[h].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,i=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=i+&quot;px&quot;,0===t&amp;&amp;(L.DomUtil.addClass(this._toolbarContainer,&quot;leaflet-draw-toolbar-notop&quot;),L.DomUtil.addClass(this._actionsContainer,&quot;leaflet-draw-actions-top&quot;)),t===e&amp;&amp;(L.DomUtil.addClass(this._toolbarContainer,&quot;leaflet-draw-toolbar-nobottom&quot;),L.DomUtil.addClass(this._actionsContainer,&quot;leaflet-draw-actions-bottom&quot;)),this._actionsContainer.style.display=&quot;block&quot;},_hideActionsToolbar:function(){this._actionsContainer.style.display=&quot;none&quot;,L.DomUtil.removeClass(this._toolbarContainer,&quot;leaflet-draw-toolbar-notop&quot;),L.DomUtil.removeClass(this._toolbarContainer,&quot;leaflet-draw-toolbar-nobottom&quot;),L.DomUtil.removeClass(this._actionsContainer,&quot;leaflet-draw-actions-top&quot;),L.DomUtil.removeClass(this._actionsContainer,&quot;leaflet-draw-actions-bottom&quot;)}}),L.Draw.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._container=t.options.drawControlTooltips?L.DomUtil.create(&quot;div&quot;,&quot;leaflet-draw-tooltip&quot;,this._popupPane):null,this._singleLineLabel=!1,this._map.on(&quot;mouseout&quot;,this._onMouseOut,this)},dispose:function(){this._map.off(&quot;mouseout&quot;,this._onMouseOut,this),this._container&amp;&amp;(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container?(t.subtext=t.subtext||&quot;&quot;,0!==t.subtext.length||this._singleLineLabel?t.subtext.length&gt;0&amp;&amp;this._singleLineLabel&amp;&amp;(L.DomUtil.removeClass(this._container,&quot;leaflet-draw-tooltip-single&quot;),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,&quot;leaflet-draw-tooltip-single&quot;),this._singleLineLabel=!0),this._container.innerHTML=(t.subtext.length&gt;0?&apos;&lt;span class=&quot;leaflet-draw-tooltip-subtext&quot;&gt;&apos;+t.subtext+&quot;&lt;/span&gt;&lt;br /&gt;&quot;:&quot;&quot;)+&quot;&lt;span&gt;&quot;+t.text+&quot;&lt;/span&gt;&quot;,this):this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;return this._container&amp;&amp;(i.style.visibility=&quot;inherit&quot;,L.DomUtil.setPosition(i,e)),this},showAsError:function(){return this._container&amp;&amp;L.DomUtil.addClass(this._container,&quot;leaflet-error-draw-tooltip&quot;),this},removeError:function(){return this._container&amp;&amp;L.DomUtil.removeClass(this._container,&quot;leaflet-error-draw-tooltip&quot;),this},_onMouseOut:function(){this._container&amp;&amp;(this._container.style.visibility=&quot;hidden&quot;)}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:&quot;draw&quot;},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&amp;&amp;t[e]&amp;&amp;(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass=&quot;leaflet-draw-draw&quot;,L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){L.setOptions(this,t);for(var e in this._modes)this._modes.hasOwnProperty(e)&amp;&amp;t.hasOwnProperty(e)&amp;&amp;this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:&quot;edit&quot;},options:{edit:{selectedPathOptions:{dashArray:&quot;10, 10&quot;,fill:!0,fillColor:&quot;#fe57a1&quot;,fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){t.edit&amp;&amp;(&quot;undefined&quot;==typeof t.edit.selectedPathOptions&amp;&amp;(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)),t.remove&amp;&amp;(t.remove=L.extend({},this.options.remove,t.remove)),t.poly&amp;&amp;(t.poly=L.extend({},this.options.poly,t.poly)),this._toolbarClass=&quot;leaflet-draw-edit&quot;,L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on(&quot;layeradd layerremove&quot;,this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off(&quot;layeradd layerremove&quot;,this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&amp;&amp;(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=this.options.featureGroup,i=0!==e.getLayers().length;this.options.edit&amp;&amp;(t=this._modes[L.EditToolbar.Edit.TYPE].button,i?L.DomUtil.removeClass(t,&quot;leaflet-disabled&quot;):L.DomUtil.addClass(t,&quot;leaflet-disabled&quot;),t.setAttribute(&quot;title&quot;,i?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&amp;&amp;(t=this._modes[L.EditToolbar.Delete.TYPE].button,i?L.DomUtil.removeClass(t,&quot;leaflet-disabled&quot;):L.DomUtil.addClass(t,&quot;leaflet-disabled&quot;),t.setAttribute(&quot;title&quot;,i?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:&quot;edit&quot;},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.setOptions(this,e),this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error(&quot;options.featureGroup must be a L.FeatureGroup&quot;);this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&amp;&amp;this._hasAvailableLayers()&amp;&amp;(this.fire(&quot;enabled&quot;,{handler:this.type}),this._map.fire(&quot;draw:editstart&quot;,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on(&quot;layeradd&quot;,this._enableLayerEdit,this).on(&quot;layerremove&quot;,this._disableLayerEdit,this))},disable:function(){this._enabled&amp;&amp;(this._featureGroup.off(&quot;layeradd&quot;,this._enableLayerEdit,this).off(&quot;layerremove&quot;,this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(&quot;draw:editstop&quot;,{handler:this.type}),this.fire(&quot;disabled&quot;,{handler:this.type}))},addHooks:function(){var t=this._map;t&amp;&amp;(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),t._editTooltip=this._tooltip,this._updateTooltip(),this._map.on(&quot;mousemove&quot;,this._onMouseMove,this).on(&quot;touchmove&quot;,this._onMouseMove,this).on(&quot;MSPointerMove&quot;,this._onMouseMove,this).on(&quot;click&quot;,this._editStyle,this).on(&quot;draw:editvertex&quot;,this._updateTooltip,this))},removeHooks:function(){this._map&amp;&amp;(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off(&quot;mousemove&quot;,this._onMouseMove,this).off(&quot;touchmove&quot;,this._onMouseMove,this).off(&quot;MSPointerMove&quot;,this._onMouseMove,this).off(&quot;click&quot;,this._editStyle,this).off(&quot;draw:editvertex&quot;,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var t=new L.LayerGroup;this._featureGroup.eachLayer(function(e){e.edited&amp;&amp;(t.addLayer(e),e.edited=!1)}),this._map.fire(&quot;draw:edited&quot;,{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:t instanceof L.Marker&amp;&amp;(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&amp;&amp;(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):t instanceof L.Marker&amp;&amp;t.setLatLng(this._uneditedLayerProps[e].latlng),t.fire(&quot;revert-edited&quot;,{layer:t}))},_enableLayerEdit:function(t){var e,i,o=t.layer||t.target||t;this._backupLayer(o),this.options.poly&amp;&amp;(i=L.Util.extend({},this.options.poly),o.options.poly=i),this.options.selectedPathOptions&amp;&amp;(e=L.Util.extend({},this.options.selectedPathOptions),e.maintainColor&amp;&amp;(e.color=o.options.color,e.fillColor=o.options.fillColor),o.options.original=L.extend({},o.options),o.options.editing=e),this.isMarker?(o.dragging.enable(),o.on(&quot;dragend&quot;,this._onMarkerDragEnd).on(&quot;touchmove&quot;,this._onTouchMove,this).on(&quot;MSPointerMove&quot;,this._onTouchMove,this).on(&quot;touchend&quot;,this._onMarkerDragEnd,this).on(&quot;MSPointerUp&quot;,this._onMarkerDragEnd,this)):o.editing.enable()},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,e.editing.disable(),delete e.options.editing,delete e.options.original,this._selectedPathOptions&amp;&amp;(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off(&quot;dragend&quot;,this._onMarkerDragEnd,this).off(&quot;touchmove&quot;,this._onTouchMove,this).off(&quot;MSPointerMove&quot;,this._onTouchMove,this).off(&quot;touchend&quot;,this._onMarkerDragEnd,this).off(&quot;MSPointerUp&quot;,this._onMarkerDragEnd,this)):e.editing.disable()},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onTouchMove:function(t){var e=t.originalEvent.changedTouches[0],i=this._map.mouseEventToLayerPoint(e),o=this._map.layerPointToLatLng(i);t.target.setLatLng(o)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:&quot;remove&quot;},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error(&quot;options.featureGroup must be a L.FeatureGroup&quot;);this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&amp;&amp;this._hasAvailableLayers()&amp;&amp;(this.fire(&quot;enabled&quot;,{handler:this.type}),this._map.fire(&quot;draw:deletestart&quot;,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on(&quot;layeradd&quot;,this._enableLayerDelete,this).on(&quot;layerremove&quot;,this._disableLayerDelete,this))},disable:function(){this._enabled&amp;&amp;(this._deletableLayers.off(&quot;layeradd&quot;,this._enableLayerDelete,this).off(&quot;layerremove&quot;,this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(&quot;draw:deletestop&quot;,{handler:this.type}),this.fire(&quot;disabled&quot;,{handler:this.type}))},addHooks:function(){var t=this._map;t&amp;&amp;(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on(&quot;mousemove&quot;,this._onMouseMove,this))},removeHooks:function(){this._map&amp;&amp;(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off(&quot;mousemove&quot;,this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t),t.fire(&quot;revert-deleted&quot;,{layer:t})},this)},save:function(){this._map.fire(&quot;draw:deleted&quot;,{layers:this._deletedLayers})},_enableLayerDelete:function(t){var e=t.layer||t.target||t;e.on(&quot;click&quot;,this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off(&quot;click&quot;,this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e),e.fire(&quot;deleted&quot;)},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(window,document);
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.8)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
